from sqlalchemy import Column, MetaData, Table
from sqlalchemy.sql.sqltypes import (
    Boolean,
    Date,
    JSON,
    DateTime,
    Numeric,
    SmallInteger,
    Text,
)

meta = MetaData()

schema = [
    Table(
        "verejna_zakazka",
        meta,
        Column("casova_znacka", DateTime, nullable=False),
        Column("identifikator_NIPEZ", Text, nullable=False, index=True),
        Column("identifikator_v_elektronickem_nastroji", Text, nullable=True),
        Column("identifikatory_v_elektronickem_nastroji", JSON, nullable=False),
        Column(
            "interniIdentifikatorVerejneZakazkyPridelenyZadavatelem",
            Text,
            nullable=True,
        ),
        Column("nazev_verejne_zakazky", Text, nullable=False),
        Column("predpokladana_hodnota_bez_DPH_v_CZK", Numeric(16, 2), nullable=True),
        Column("predpokladana_hodnota_bez_DPH", Numeric(16, 2), nullable=True),
        Column("predpokladana_hodnota_bez_DPH_mena", Text, nullable=True),
        Column("predpokladana_hodnota_bude_uverejnena", Boolean, nullable=True),
        Column(
            "predp_hodnota_vz__ramcove_dohody_bez_DPH_v_CZK",
            Numeric(16, 2),
            nullable=True,
        ),
        Column(
            "predp_hodnota_vz__ramcove_dohody_bez_DPH",
            Numeric(16, 2),
            nullable=True,
        ),
        Column(
            "predp_hodnota_vz__ramcove_dohody_bez_DPH_mena",
            Text,
            nullable=True,
        ),
        Column("druh_verejne_zakazky", Text, nullable=True),
        Column("vedlejsi_druhy_verejne_zakazky", JSON, nullable=False),
        Column("rezim_verejne_zakazky", Text, nullable=True),
        Column("rezim_dle_volby_zadavatele", Text, nullable=True),
        Column("predmet", JSON, nullable=False),
        Column(
            "oduvodneni_nerozdeleni_nadlimitni_verejne_zakazky_na_casti",
            Text,
            nullable=True,
        ),
        Column(
            "typ_verejne_zakazky_dle_vyse_predpokladane_hodnoty", Text, nullable=True
        ),
        Column("hodnoty_koncese", JSON, nullable=False),
        # TODO: splitni tohle do zvlast tabulky
        Column("casti_verejne_zakazky", JSON, nullable=False),
        Column("zadavaci_postupy", Text, nullable=False),
    ),
    Table(
        "dynamicky_nakupni_system",
        meta,
        Column("casova_znacka", DateTime, nullable=False),
        Column("identifikator_NIPEZ", Text, nullable=False, index=True),
        Column("identifikator_v_elektronickem_nastroji", Text, nullable=True),
        Column("identifikatory_v_elektronickem_nastroji", JSON, nullable=False),
        Column(
            "interni_identifikator_dynamickeho_nakupniho_systemu_prideleny_zadavatelem",
            Text,
            nullable=True,
        ),
        Column("evidencni_cislo_ve_Vestniku_verejnych_zakazek", Text, nullable=True),
        Column("nazev_dynamickeho_nakupniho_systemu", Text, nullable=False),
        Column(
            "predpokladana_hodnota_dynamickeho_nakupniho_systemu_bez_DPH_v_CZK",
            Numeric(16, 2),
            nullable=True,
        ),
        Column(
            "predpokladana_hodnota_dynamickeho_nakupniho_systemu_bez_DPH",
            Numeric(16, 2),
            nullable=True,
        ),
        Column(
            "predpokladana_hodnota_dynamickeho_nakupniho_systemu_bez_DPH_mena",
            Text,
            nullable=True,
        ),
        Column("predpokladana_hodnota_bude_uverejnena", Boolean, nullable=True),
        Column("url", Text, nullable=True),
        Column("druh_verejne_zakazky", Text, nullable=False),
        Column("rezim_verejne_zakazky", Text, nullable=True),
        Column("rezim_dle_volby_zadavatele", Text, nullable=True),
        Column(
            "zadavaci_postup_pro_zavedeni_dynamickeho_nakupniho_systemu",
            Text,
            nullable=False,
        ),
        Column(
            "predmet_verejne_zakazky_zadavany_v_dynamickem_nakupnim_systemu",
            JSON,
            nullable=True,
        ),
        Column("kriteria_kvalifikace", JSON, nullable=True),
        Column(
            "verejna_zakazka_je_alespon_castecne_financovana_z_prostredku_Evropske_unie",
            Boolean,
            nullable=True,
        ),
        Column("informace_o_financnich_prostredcich_EU", Text, nullable=False),
        Column("kategorie_dynamickeho_nakupniho_systemu", Text, nullable=False),
        Column("doba_trvani", Text, nullable=False),
        Column("vedlejsi_druhy_verejne_zakazky", JSON, nullable=False),
        Column(
            "dodavatele_zadajici_o_ucast_v_dynamickem_nakupnim_systemu",
            JSON,
            nullable=False,
        ),
        Column(
            "ucastnici_zarazeni_do_dynamickeho_nakupniho_systemu", JSON, nullable=False
        ),
        Column("kriterium_pro_hodnoceni_nabidek", JSON, nullable=False),
        Column(
            "informace_o_otevirani_podani_v_zadavacim_postupu_pro_zavedeni_dynamickeho_nakupniho_systemu",
            Text,
            nullable=True,
        ),
        Column("predmet", JSON, nullable=True),
        Column(
            "evidencni_cislo_zadavaciho_postupu_ve_vestniku_verejnych_zakazek",
            Text,
            nullable=True,
        ),
    ),
    Table(
        "soutez_o_navrh",
        meta,
        Column("casova_znacka", DateTime, nullable=False),
        Column("identifikator_NIPEZ", Text, nullable=False, index=True),
        Column("identifikator_v_elektronickem_nastroji", Text, nullable=True),
        Column("identifikatory_v_elektronickem_nastroji", JSON, nullable=False),
        Column(
            "interni_identifikator_souteze_o_navrh_prideleny_zadavatelem",
            Text,
            nullable=True,
        ),
        Column("identifikator_CELEX_pravniho_predpisu_EU", Text, nullable=True),
        Column("zadavatel_zadavaciho_postupu", JSON, nullable=False),
        Column("evidencni_cislo_ve_VVZ", Text, nullable=True),
        Column("nazev_souteze_o_navrh", Text, nullable=False),
        Column("stav", Text, nullable=True),
        Column("kategorie_zadavaciho_postupu", Text, nullable=True),
        Column("druh_zadavaciho_postupu", Text, nullable=False),
        Column(
            "pravni_predpis_EU_na_zaklade_nehoz_probiha_zadavaci_postup",
            Text,
            nullable=True,
        ),
        Column("pravni_predpis_EU", Text, nullable=True),
        Column("datum_zahajeni_zadavaciho_postupu", Date, nullable=True),
        Column("datum_ukonceni_zadavaciho_postupu", Date, nullable=True),
        Column("evidence_vysledku_zadavaciho_postupu", Text, nullable=True),
        Column("udeleni_cen_odmen_nebo_jinych_plateb", Boolean, nullable=True),
        Column(
            "predpokladana_vyse_cen_odmen_nebo_jinych_plateb",
            Numeric(16, 2),
            nullable=True,
        ),
        Column(
            "predpokladana_vyse_cen_odmen_nebo_jinych_plateb_mena",
            Text,
            nullable=True,
        ),
        Column(
            "predpokladana_vyse_cen_odmen_nebo_jinych_plateb_bude_uverejnena",
            Boolean,
            nullable=True,
        ),
        Column("dalsi_informace_v_souvislosti_s_odmenami", Text, nullable=True),
        Column("ocenovane_umisteni", JSON, nullable=True),
        Column("pocet_podanych_navrhu", SmallInteger, nullable=True),
        Column(
            "pocet_zaslanych_zaevidovanych_vysvetleni_souteznich_podminek",
            SmallInteger,
            nullable=True,
        ),
        Column("presne_informace_o_lhutach_pro_prezkumna_rizeni", Text, nullable=True),
        Column("dalsi_informace", Text, nullable=True),
        Column(
            "soutez_o_navrh_a_navazujici_verejna_zakazka_jsou_alespon_castecne_financovany_z_prostredku_Evropske_unie",
            Boolean,
            nullable=True,
        ),
        Column("ucastnici_zadavaciho_postupu", JSON, nullable=False),
        Column("ucastnici_jimz_zanikla_ucast_v_zadavacim_postupu", JSON, nullable=True),
        Column("vysledek_zadavaciho_postupu", JSON, nullable=True),
        Column("podane_soutezni_navrhy", JSON, nullable=False),
        Column("pravidla_pro_hodnoceni_souteznich_navrhu", Text, nullable=True),
        Column("kriteria_kvalifikace", JSON, nullable=True),
        Column("namitky", JSON, nullable=False),
        Column("lhuty", JSON, nullable=False),
        Column("informace_o_otevirani_podani", Text, nullable=False),
        Column("specifikace_podani_souteznich_navrhu", Text, nullable=True),
        Column("informace_o_dalsi_fazi_uzsi_souteze_o_navrh", Text, nullable=True),
        Column("informace_o_souteznich_podminkach", Text, nullable=False),
        Column("spolecne_zadavani_zadavatelu_z_ruznych_statu", JSON, nullable=False),
        Column("predmet_souteze_o_navrh", JSON, nullable=False),
        Column("informace_o_financnich_prostredcich_EU", Text, nullable=False),
        Column("stret_zajmu", Text, nullable=False),
        Column("uverejnovaci_formulare", JSON, nullable=False),
        Column("zadavani_inovaci", Text, nullable=False),
        Column("socialne_odpovedne_zadavani", Text, nullable=False),
        Column("environmentalni_zadavani", Text, nullable=False),
        Column("enviromentalni_zadavani_podle_kriterii", JSON, nullable=True),
        Column("popis_odpovedneho_zadavani", Text, nullable=False),
        Column("informace_o_danovych_pravnich_predpisech", Text, nullable=False),
        Column("informace_o_pracovnepravnich_predpisech", Text, nullable=False),
        Column(
            "informace_o_predpisech_v_oblasti_zivotniho_prostredi", Text, nullable=False
        ),
        Column("nestandardni_stavy", JSON, nullable=True),
        Column("dokumenty", JSON, nullable=True),
        Column("informace_o_druhe_fazi_uzsi_souteze_o_navrh", Text, nullable=True),
        Column("vylouceni_ucastnici_kteri_podali_vybrany_navrh", JSON, nullable=True),
        Column("kriteria_enviromentalnich_verejnych_zakazek", JSON, nullable=True),
        Column("vylouceni_ucastnici_zadavaciho_postupu", JSON, nullable=True),
        Column(
            "evidencni_cislo_zadavaciho_postupu_ve_vestniku_verejnych_zakazek",
            Text,
            nullable=True,
        ),
    ),
    Table(
        "system_kvalifikace",
        meta,
        Column("casova_znacka", DateTime, nullable=False),
        Column("identifikator_NIPEZ", Text, nullable=False, index=True),
        Column("identifikator_v_elektronickem_nastroji", Text, nullable=True),
        Column("identifikatory_v_elektronickem_nastroji", JSON, nullable=False),
        Column("datum_zavedeni_systemu_kvalifikace", Date, nullable=False),
        Column("nazev_systemu_kvalifikace", Text, nullable=False),
        Column("predmet", JSON, nullable=False),
        Column("platba_za_zarazeni_do_systemu_kvalifikace", Boolean, nullable=False),
        Column("vyse_platby_bez_DPH", Numeric(16, 2), nullable=True),
        Column("vyse_platby_s_DPH", Numeric(16, 2), nullable=True),
        Column("mena", Text, nullable=True),
        Column("kvalifikace", JSON, nullable=False),
        Column("zadavatel_systemu_kvalifikace", JSON, nullable=False),
        Column("kategorie_systemu_kvalifikace", Text, nullable=False),
        Column("dodavatele_zarazeni_do_systemu_kvalifikace", JSON, nullable=False),
        Column("lhuty", JSON, nullable=False),
        Column("doba_trvani", Text, nullable=False),
        Column("uverejnovaci_formulare", JSON, nullable=False),
    ),
]

# -- TODO: foreign keys? composite primary keys?

if __name__ == "__main__":
    from sqlalchemy.dialects import postgresql
    from sqlalchemy.schema import CreateTable

    for table in schema:
        print(f"-- {table.name} as created in Postgres")

        print(CreateTable(table).compile(dialect=postgresql.dialect()))
